{% extends "base.html" %}

{% block title %}Panel Principal{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- Título del panel -->
  <h2 class="mb-4 text-success">
    <i class="bi bi-person-circle"></i> Bienvenido, {{ current_user.name }}
  </h2>
  <p class="text-muted">Panel principal — Rol: <strong>{{ current_user.role|capitalize }}</strong></p>

  {% if notificaciones %}
  <div class="alert alert-light border-start border-4 border-success shadow-sm mb-4">
    <h5><i class="bi bi-bell-fill text-success"></i> Notificaciones</h5>
    <ul class="mb-0 ps-3">
      {% for n in notificaciones %}
        <li><strong>{{ n.titulo }}</strong> — {{ n.mensaje }} <small class="text-muted">({{ n.fecha.strftime('%d-%m-%Y') }})</small></li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if current_user.role == 'admin' %}

  <!-- Panel de acciones administrativas -->
  <div class="row g-3 mb-4">
    <!-- Crear Técnico -->
    <div class="col-md-6">
      <div class="card border-primary shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title"><i class="bi bi-person-plus"></i> Crear Perfil Técnico Agrónomo</h5>
          <p class="card-text">Registrar nuevos técnicos para supervisión de huertos, bodegas e inventario.</p>
          <a href="{{ url_for('admin.crear_tecnico') }}" class="btn btn-primary">Ir a formulario</a>
        </div>
      </div>
    </div>
    <!-- Asignar Recomendación -->
    <div class="col-md-6">
      <div class="card border-warning shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title"><i class="bi bi-chat-left-dots"></i> Asignar Recomendación</h5>
          <p class="card-text">Enviar indicaciones agronómicas personalizadas a cada técnico.</p>
          <a href="{{ url_for('admin.recomendar') }}" class="btn btn-warning text-white">Asignar</a>
        </div>
      </div>
    </div>
  </div>

  <!-- Estadísticas rápidas -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card text-white bg-primary mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="bi bi-person-lines-fill fs-2 me-3"></i>
          <div>
            <h4 class="mb-0">{{ tecnicos|length }}</h4>
            <small>Técnicos</small>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white bg-success mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="bi bi-tree fs-2 me-3"></i>
          <div>
            <h4 class="mb-0">{{ huertos|length }}</h4>
            <small>Huertos</small>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white bg-warning mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="bi bi-box-seam fs-2 me-3"></i>
          <div>
            <h4 class="mb-0">{{ bodegas|length }}</h4>
            <small>Bodegas</small>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-white bg-secondary mb-3">
        <div class="card-body d-flex align-items-center">
          <i class="bi bi-list-check fs-2 me-3"></i>
          <div>
            <h4 class="mb-0">{{ ultimas_recomendaciones|length }}</h4>
            <small>Recomendaciones</small>
          </div>
        </div>
      </div>
    </div>
  </div>


     