{% extends "base.html" %}
{% block title %}Registrar Actividad de Huerto{% endblock %}
{% block content %}
<div class="container my-4">
  <h2 class="mb-4 text-success">Registrar Actividad en Huerto: {{ huerto.nombre }}</h2>
  <form method="POST" enctype="multipart/form-data">
    {{ form.hidden_tag() }}
    <div class="row">
      <div class="col-md-4">{{ form.fecha.label }} {{ form.fecha(class="form-control") }}</div>
      <div class="col-md-4">{{ form.tipo.label }} {{ form.tipo(class="form-control", id="tipo-actividad") }}</div>
      <div class="col-md-4">{{ form.responsable.label }} {{ form.responsable(class="form-control") }}</div>
    </div>
    <div class="row mt-3">
      <div class="col-12">{{ form.descripcion.label }} {{ form.descripcion(class="form-control") }}</div>
    </div>
    <!-- Campos para Control de Plagas, visibles solo si corresponde -->
    <div id="plagas-campos" style="display: none;">
      <div class="row mt-3">
        <div class="col-md-4">{{ form.plaga.label }} {{ form.plaga(class="form-control") }}</div>
        <div class="col-md-4">{{ form.nivel_infestacion.label }} {{ form.nivel_infestacion(class="form-control") }}</div>
        <div class="col-md-4">{{ form.producto.label }} {{ form.producto(class="form-control") }}</div>
      </div>
      <div class="row mt-3">
        <div class="col-md-6">{{ form.dosis.label }} {{ form.dosis(class="form-control") }}</div>
        <div class="col-md-6">{{ form.resultado.label }} {{ form.resultado(class="form-control") }}</div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-md-6">{{ form.fotos.label }} {{ form.fotos(class="form-control-file") }}</div>
      <div class="col-md-6">{{ form.observaciones.label }} {{ form.observaciones(class="form-control") }}</div>
    </div>
    <div class="mt-4">
      {{ form.submit(class="btn btn-success") }}
      <a href="{{ url_for('bitacora_huerto', huerto_id=huerto.id) }}" class="btn btn-secondary ml-2">Cancelar</a>
    </div>
  </form>
</div>

<script>
  // Mostrar u ocultar campos de control de plagas seg√∫n el tipo de actividad seleccionado
  function togglePlagasCampos() {
    const tipo = document.getElementById("tipo-actividad").value;
    document.getElementById("plagas-campos").style.display =
      tipo === "control_plagas" ? "block" : "none";
  }
  document.getElementById("tipo-actividad").addEventListener("change", togglePlagasCampos);
  window.onload = togglePlagasCampos;
</script>
{% endblock %}
