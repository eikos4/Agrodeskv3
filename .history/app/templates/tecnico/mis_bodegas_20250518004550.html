{% extends "base.html" %}
{% block title %}Mis Bodegas{% endblock %}

{% block content %}
<div class="container py-4">

  <!-- Título de página -->
  <h2 class="mb-4 text-success">
    <i class="bi bi-box-seam"></i> Bodegas a mi cargo
  </h2>

  <div class="row g-4">
    {% for bodega in bodegas %}
      <div class="col-12 col-md-6 col-lg-4">
        <div class="card border-success shadow-lg h-100 position-relative">

          <!-- Badge de ID arriba a la derecha -->
          

          <!-- Header: nombre y huerto -->
          <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
            <div>
              <i class="bi bi-house-door-fill"></i> {{ bodega.nombre }}
            </div>
            <span class="badge bg-light text-success">
              Huerto: {{ bodega.huerto.nombre }}
            </span>
          </div>

          <!-- Body: info general -->
          <div class="card-body">
            <p class="mb-1">
              <i class="bi bi-geo-alt-fill text-success"></i>
              <strong>Ubicación:</strong> {{ bodega.ubicacion or "—" }}
            </p>
            <p class="mb-1">
              <i class="bi bi-person-badge-fill text-primary"></i>
              <strong>Responsable:</strong>
              {{ bodega.responsable.name if bodega.responsable else "—" }}
            </p>
            <p class="mb-3">
              <i class="bi bi-flask text-info"></i>
              <strong>Químicos:</strong>
              <span class="badge bg-info">{{ bodega.quimicos|length }}</span>
            </p>
            {% if bodega.quimicos %}
              <ul class="list-group list-group-flush mb-2">
                {% for q in bodega.quimicos[:3] %}
                  <li class="list-group-item d-flex justify-content-between align-items-center small">
                    {{ q.nombre }}
                    <span class="badge bg-secondary">{{ q.cantidad_litros }} L</span>
                  </li>
                {% endfor %}
                {% if bodega.quimicos|length > 3 %}
                  <li class="list-group-item text-end small text-muted">
                    +{{ bodega.quimicos|length - 3 }} químicos más…
                  </li>
                {% endif %}
              </ul>
            {% endif %}
          </div>

          <!-- Footer: acciones rápidas -->
          <div class="card-footer bg-light d-flex flex-wrap gap-2 justify-content-end">
            <a href="{{ url_for('tecnico.ver_quimicos', bodega_id=bodega.id) }}" class="btn btn-outline-success btn-sm">
              <i class="bi bi-flask"></i> Ver Químicos
            </a>
            <a href="{{ url_for('tecnico.agregar_quimico', bodega_id=bodega.id) }}" class="btn btn-outline-primary btn-sm">
              <i class="bi bi-plus-circle"></i> Agregar Químico
            </a>
          </div>
        </div>
      </div>
    {% else %}
      <div class="col-12">
        <div class="alert alert-info text-center mb-0">
          <i class="bi bi-info-circle"></i> No tienes bodegas asignadas aún.
        </div>
      </div>
    {% endfor %}
  </div>

</div>
{% endblock %}
